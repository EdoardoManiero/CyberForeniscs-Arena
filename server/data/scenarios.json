{
  "file_system_forensic": {
    "id": "file_system_forensic",
    "title": "File System Forensic",
    "description": "Analyze storage devices and find the evidence",
    "introduction": "A suspicious hard disk has been seized. You must follow proper forensic procedures: hash the original evidence, create a forensic copy, verify integrity, then examine the file system to find hidden evidence.",
    "badge": "File System Forensic Expert",
    "interactableObjects": [
      "HD1-01_HD-1_0",
      "LinuxComputer"
    ],
    "customCommands": [
      {
        "name": "sha256sum",
        "description": "Compute SHA256 hash of a file or device",
        "type": "command",
        "requiresArgs": true,
        "validArgs": {
          "/dev/sdb": "SHA256(/dev/sdb) = 3a7bd3e2360a3d29eea436fcfb7e44c735d117c42d1c1835420b6b9942dd4f1a\nHash computed successfully. Record this value for chain of custody.",
          "/forensic/evidence.img": "SHA256(/forensic/evidence.img) = 3a7bd3e2360a3d29eea436fcfb7e44c735d117c42d1c1835420b6b9942dd4f1a\n[✓] Hash MATCHES original evidence - Integrity verified!"
        },
        "output": "Usage: sha256sum <file or device>\nComputes cryptographic hash for forensic integrity verification."
      },
      {
        "name": "dd",
        "description": "Create bit-by-bit forensic copy of a device",
        "type": "command",
        "requiresArgs": true,
        "validArgs": {
          "if=/dev/sdb of=/forensic/evidence.img": "Creating forensic image...\n  Source: /dev/sdb (500MB)\n  Destination: /forensic/evidence.img\n  Block size: 4096 bytes\n\n122880+0 records in\n122880+0 records out\n503316480 bytes (500 MB) copied, 2.34 s, 215 MB/s\n\n[✓] Forensic image created successfully at /forensic/evidence.img"
        },
        "output": "Usage: dd if=<source> of=<destination>\nCreates bit-by-bit copy for forensic analysis."
      }
    ],
    "tasks": [
      {
        "id": "fs_task_1",
        "title": "Connect the hard disk to the workstation",
        "details": "Click on the hard disk to physically connect it to the forensic PC",
        "points": 10,
        "checkType": "interaction",
        "interactionTarget": "HD1-01_HD-1_0",
        "onInteract": {
          "action": "attach_device",
          "deviceName": "sdb",
          "deviceType": "disk",
          "message": " Hard disk connected as /dev/sdb\nUse 'lsblk' to display available devices",
          "mountContent": {
            "suspicious.log": "2024-10-15 03:45:12 - Unauthorized access attempt\n2024-10-15 03:45:34 - Login from 192.168.1.50\n2024-10-15 03:47:21 - File system modified: /etc/shadow\npassword: forensic2024",
            "deleted_files.txt": "Recovered files:\n- secret_document.pdf (deleted 2024-10-15 04:12)\n- evidence.docx (deleted 2024-10-15 04:13)",
            "system_info.txt": "System: Ubuntu 22.04 LTS\nKernel: 5.15.0-89-generic\nLast boot: 2024-10-15 03:30:00"
          }
        },
        "hintCost": 2,
        "hasHint": false,
        "checkCommand": null,
        "checkArgs": null
      },
      {
        "id": "fs_task_2",
        "title": "List connected devices",
        "details": "Use 'lsblk' to see available disks",
        "points": 15,
        "checkType": null,
        "interactionTarget": null,
        "onInteract": null,
        "hintCost": 3,
        "hasHint": false,
        "checkCommand": "lsblk",
        "checkArgs": []
      },
      {
        "id": "fs_task_3",
        "title": "Calculate SHA256 hash of the original evidence",
        "details": "Before any analysis, compute a cryptographic hash of the original disk to establish integrity. Use 'sha256sum /dev/sdb'",
        "points": 20,
        "checkType": null,
        "interactionTarget": null,
        "onInteract": null,
        "hintCost": 4,
        "hasHint": true,
        "hint": "Hash the original device with: sha256sum /dev/sdb",
        "checkCommand": "sha256sum",
        "checkArgs": ["/dev/sdb"]
      },
      {
        "id": "fs_task_4",
        "title": "Create a forensic copy using dd",
        "details": "Never work on original evidence! Create a bit-by-bit forensic image. Use 'dd if=/dev/sdb of=/forensic/evidence.img'",
        "points": 25,
        "checkType": null,
        "interactionTarget": null,
        "onInteract": null,
        "hintCost": 5,
        "hasHint": true,
        "hint": "Create forensic copy: dd if=/dev/sdb of=/forensic/evidence.img",
        "checkCommand": "dd",
        "checkArgs": ["if=/dev/sdb", "of=/forensic/evidence.img"]
      },
      {
        "id": "fs_task_5",
        "title": "Verify forensic copy integrity",
        "details": "Hash the forensic image and compare with the original hash. They must match! Use 'sha256sum /forensic/evidence.img'",
        "points": 20,
        "checkType": null,
        "interactionTarget": null,
        "onInteract": null,
        "hintCost": 4,
        "hasHint": true,
        "hint": "Verify copy integrity: sha256sum /forensic/evidence.img",
        "checkCommand": "sha256sum",
        "checkArgs": ["/forensic/evidence.img"]
      },
      {
        "id": "fs_task_6",
        "title": "Mount the forensic copy read-only",
        "details": "Mount the forensic image (not original!) in read-only mode to prevent accidental modification. Use 'mount -o ro /forensic/evidence.img /mnt/evidence'",
        "points": 20,
        "checkType": null,
        "interactionTarget": null,
        "onInteract": null,
        "hintCost": 4,
        "hasHint": true,
        "hint": "Mount read-only: mount -o ro /forensic/evidence.img /mnt/evidence",
        "checkCommand": "mount",
        "checkArgs": ["-o", "ro", "/forensic/evidence.img", "/mnt/evidence"]
      },
      {
        "id": "fs_task_7",
        "title": "Explore the contents",
        "details": "Use 'ls' to see files on the disk",
        "points": 15,
        "checkType": null,
        "interactionTarget": null,
        "onInteract": null,
        "hintCost": 3,
        "hasHint": true,
        "checkCommand": "ls",
        "checkArgs": [
          "/mnt/evidence"
        ],
        "hint": "use 'ls /mnt/evidence/'"
      },
      {
        "id": "fs_task_8",
        "title": "Search for suspicious files",
        "details": "Use 'cat /mnt/evidence/suspicious.log' to read the log",
        "points": 20,
        "checkType": null,
        "interactionTarget": null,
        "onInteract": null,
        "hintCost": 4,
        "hasHint": false,
        "checkCommand": "cat",
        "checkArgs": [
          "/mnt/evidence/suspicious.log"
        ]
      },
      {
        "id": "fs_task_9",
        "title": "Search for password in the log",
        "details": "Use 'grep password /mnt/evidence/suspicious.log'",
        "points": 25,
        "checkType": null,
        "interactionTarget": null,
        "onInteract": null,
        "hintCost": 5,
        "hasHint": false,
        "checkCommand": "grep",
        "checkArgs": [
          "password",
          "/mnt/evidence/suspicious.log"
        ]
      }
    ]
  },
  "network_forensic": {
    "id": "network_forensic",
    "title": "Network Forensic",
    "description": "Analyze network traffic and system logs",
    "introduction": "A server has been compromised. You need to analyze authentication logs and network traffic to identify the attacker. First, you must trace the signal to locate the server, then follow forensic best practices before analysis.",
    "badge": "Network Forensic Expert",
    "interactableObjects": [
      "Server",
      "LinuxComputer"
    ],
    "customCommands": [
      {
        "name": "trace-connection",
        "description": "Trace signal to remote server",
        "type": "minigame",
        "gameType": "signal-tracing",
        "output": "[*] Initiating Network Traffic Analysis... [TARGET: Identify C2 IP Address]",
        "onSuccess": "Trace Complete. Target IP Identified: 10.0.0.5. Use 'nmap 10.0.0.5' to scan the target.",
        "nextTask": "scan-target"
      },
      {
        "name": "nmap",
        "description": "Network exploration tool and security / port scanner",
        "type": "command",
        "output": "Scanning 10.0.0.5...\nPORT    STATE SERVICE\n22/tcp  open  ssh\n80/tcp  open  http\n443/tcp open  https\n\nVulnerability detected on port 22 (SSH-2.0-OpenSSH_7.6p1)."
      },
      {
        "name": "sha256sum",
        "description": "Compute SHA256 hash of files for integrity verification",
        "type": "command",
        "requiresArgs": true,
        "validArgs": {
          "/var/log/network/*": "SHA256(/var/log/network/auth.log) = 8f14e45fceea167a5a36dedd4bea2543e4c4e5a6b7c8d9e0f1a2b3c4d5e6f7a8\nSHA256(/var/log/network/network.pcap) = 2c624232cdd221771294dfbb310aca000a0df6ac8b66b696d90ef06fdefb64a3\nSHA256(/var/log/network/firewall.log) = 9f86d081884c7d659a2feaa0c55ad015a3bf4f1b2b0b822cd15d6c15b0f00a08\n\n[✓] Hashes recorded for chain of custody documentation."
        },
        "output": "Usage: sha256sum <file(s)>\nComputes cryptographic hash for forensic integrity verification."
      },
      {
        "name": "cp",
        "description": "Copy files or directories",
        "type": "command",
        "requiresArgs": true,
        "validArgs": {
          "-r /var/log/network /forensic/logs": "Creating forensic working copies...\n  '/var/log/network/auth.log' -> '/forensic/logs/auth.log'\n  '/var/log/network/network.pcap' -> '/forensic/logs/network.pcap'\n  '/var/log/network/firewall.log' -> '/forensic/logs/firewall.log'\n\n[✓] Working copies created in /forensic/logs/\n[!] Original evidence preserved - analysis will use copies."
        },
        "output": "Usage: cp [-r] <source> <destination>\nCopies files/directories for forensic analysis."
      }
    ],
    "tasks": [
      {
        "id": "net_task_0",
        "title": "Trace signal to server",
        "details": "Use 'trace-connection' to locate the remote server",
        "points": 10,
        "checkType": null,
        "interactionTarget": null,
        "onInteract": null,
        "hintCost": 2,
        "hasHint": false,
        "checkCommand": "trace-connection",
        "checkArgs": []
      },
      {
        "id": "net_task_1",
        "title": "Scan the target IP",
        "details": "Use 'nmap 10.0.0.5' to scan the identified target",
        "points": 10,
        "checkType": null,
        "interactionTarget": null,
        "onInteract": null,
        "hintCost": 2,
        "hasHint": false,
        "checkCommand": "nmap",
        "checkArgs": [
          "10.0.0.5"
        ]
      },
      {
        "id": "net_task_2",
        "title": "Connect to the remote server",
        "details": "Click on the server to establish an SSH connection",
        "points": 10,
        "checkType": "interaction",
        "interactionTarget": "Server",
        "onInteract": {
          "action": "attach_device",
          "deviceName": "remote_server",
          "deviceType": "remote",
          "mountPoint": "/var/log/network",
          "message": " Connected to server 10.0.0.5 via SSH\nLogs available. Use 'ls /var/log/network'",
          "mountContent": {
            "auth.log": "Oct 15 03:45:10 server sshd[1234]: Failed password for admin from 192.168.1.50\nOct 15 03:45:15 server sshd[1234]: Failed password for admin from 192.168.1.50\nOct 15 03:45:23 server sshd[1234]: Accepted password for admin from 192.168.1.50",
            "network.pcap": "[Binary packet capture - 15MB]\nHTTP requests to suspicious domains detected",
            "firewall.log": "DENY 192.168.1.100 -> 10.0.0.5:3389 [RDP]\nALLOW 192.168.1.50 -> 10.0.0.5:22 [SSH]"
          }
        },
        "hintCost": 2,
        "hasHint": false,
        "checkCommand": null,
        "checkArgs": null
      },
      {
        "id": "net_task_3",
        "title": "Hash network capture files before analysis",
        "details": "Before analyzing evidence, compute hashes of all log files for integrity documentation. Use 'sha256sum /var/log/network/*'",
        "points": 20,
        "checkType": null,
        "interactionTarget": null,
        "onInteract": null,
        "hintCost": 4,
        "hasHint": true,
        "hint": "Hash all log files: sha256sum /var/log/network/*",
        "checkCommand": "sha256sum",
        "checkArgs": ["/var/log/network/*"]
      },
      {
        "id": "net_task_4",
        "title": "Create working copies of log files",
        "details": "Create copies of evidence files for analysis, preserving originals. Use 'cp -r /var/log/network /forensic/logs'",
        "points": 20,
        "checkType": null,
        "interactionTarget": null,
        "onInteract": null,
        "hintCost": 4,
        "hasHint": true,
        "hint": "Copy logs: cp -r /var/log/network /forensic/logs",
        "checkCommand": "cp",
        "checkArgs": ["-r", "/var/log/network", "/forensic/logs"]
      },
      {
        "id": "net_task_5",
        "title": "List system logs",
        "details": "Now work with the forensic copies in /forensic/logs. Use ls to explore the content.",
        "points": 15,
        "checkType": null,
        "interactionTarget": null,
        "onInteract": null,
        "hintCost": 3,
        "hasHint": false,
        "checkCommand": "ls",
        "checkArgs": [
          "/forensic/logs"
        ]
      },
      {
        "id": "net_task_6",
        "title": "Read authentication logs",
        "details": "Use 'cat /var/log/network/auth.log'",
        "points": 20,
        "checkType": null,
        "interactionTarget": null,
        "onInteract": null,
        "hintCost": 4,
        "hasHint": false,
        "checkCommand": "cat",
        "checkArgs": [
          "/var/log/network/auth.log"
        ]
      },
      {
        "id": "net_task_7",
        "title": "Search for failed SSH attempts",
        "details": "Use 'grep \"Failed password\" /var/log/network/auth.log'",
        "points": 20,
        "checkType": null,
        "interactionTarget": null,
        "onInteract": null,
        "hintCost": 4,
        "hasHint": false,
        "checkCommand": "grep",
        "checkArgs": [
          "Failed password",
          "/var/log/network/auth.log"
        ]
      },
      {
        "id": "net_task_8",
        "title": "Analyze packet capture",
        "details": "Use 'tcpdump' to see captured traffic statistics",
        "points": 25,
        "checkType": null,
        "interactionTarget": null,
        "onInteract": null,
        "hintCost": 5,
        "hasHint": false,
        "checkCommand": "tcpdump",
        "checkArgs": []
      }
    ]
  },
  "memory_forensic": {
    "id": "memory_forensic",
    "title": "Memory Forensic",
    "description": "Analyze RAM memory dump to find artifacts",
    "introduction": "A RAM memory dump contains traces of malware. Before analysis, you must verify the dump's integrity and create a working copy. Then analyze it using forensic tools to discover what malicious processes were running.",
    "badge": "Memory Forensic Expert",
    "interactableObjects": [
      "HD2-01_HD-2_0",
      "LinuxComputer"
    ],
    "customCommands": [
      {
        "name": "sha256sum",
        "description": "Compute SHA256 hash of a file or device",
        "type": "command",
        "requiresArgs": true,
        "validArgs": {
          "/dev/sdc": "SHA256(/dev/sdc) = e3b0c44298fc1c149afbf4c8996fb92427ae41e4649b934ca495991b7852b855\n\n[✓] Hash computed successfully.\n[!] Record this value - it proves the memory dump has not been modified."
        },
        "output": "Usage: sha256sum <file or device>\nComputes cryptographic hash for forensic integrity verification."
      },
      {
        "name": "dd",
        "description": "Create bit-by-bit forensic copy of a device",
        "type": "command",
        "requiresArgs": true,
        "validArgs": {
          "if=/dev/sdc of=/forensic/memdump.img": "Creating forensic copy of memory dump...\n  Source: /dev/sdc (8GB memory image)\n  Destination: /forensic/memdump.img\n  Block size: 4096 bytes\n\n2097152+0 records in\n2097152+0 records out\n8589934592 bytes (8.6 GB) copied, 45.2 s, 190 MB/s\n\n[✓] Memory dump copy created at /forensic/memdump.img\n[!] Original evidence on /dev/sdc preserved."
        },
        "output": "Usage: dd if=<source> of=<destination>\nCreates bit-by-bit copy for forensic analysis."
      },
      {
        "name": "memdump-info",
        "description": "Display memory dump metadata and statistics",
        "output": "Memory Dump Analysis\n====================\nSize: 8GB\nOS: Windows 10 x64\nCaptured: 2024-10-15 03:45:00\nHash: a7f3e8c9d2b1f4e6"
      },
      {
        "name": "find-malware",
        "description": "Scan for malicious signatures in memory",
        "type": "minigame",
        "gameType": "decryption",
        "output": "[*] Scanning memory for malware signatures...\n[!] Found 3 suspicious processes:\n  - PID 1234: suspicious.exe (RISK: HIGH)\n  - PID 5678: malware.dll (RISK: CRITICAL)\n  - PID 9012: keylogger.sys (RISK: CRITICAL)"
      }
    ],
    "tasks": [
      {
        "id": "mem_task_1",
        "title": "Connect the HD with memory dump",
        "details": "Click on the hard disk containing the RAM dump",
        "points": 10,
        "checkType": "interaction",
        "interactionTarget": "HD2-01",
        "onInteract": {
          "action": "attach_device",
          "deviceName": "sdc",
          "deviceType": "disk",
          "size": "16G",
          "message": " Device connected as /dev/sdc\nContains 8GB memory dump",
          "mountContent": {
            "memory.dmp": "[Binary memory dump - 8GB]\nWindows 10 x64 memory image",
            "process_list.txt": "PID 1234 - suspicious.exe\nPID 5678 - malware.dll\nPID 9012 - keylogger.sys\nPID 4321 - backdoor.exe",
            "registry_hives.txt": "HKEY_LOCAL_MACHINE\\\\SOFTWARE\\\\Microsoft\\\\Windows\\\\CurrentVersion\\\\Run\n- Malware: C:\\\\Windows\\\\Temp\\\\evil.exe"
          }
        },
        "hintCost": 2,
        "hasHint": false,
        "checkCommand": null,
        "checkArgs": null
      },
      {
        "id": "mem_task_2",
        "title": "Verify devices",
        "details": "Use 'lsblk' to confirm the connected device",
        "points": 15,
        "checkType": null,
        "interactionTarget": null,
        "onInteract": null,
        "hintCost": 3,
        "hasHint": false,
        "checkCommand": "lsblk",
        "checkArgs": []
      },
      {
        "id": "mem_task_3",
        "title": "Verify dump integrity (hash check)",
        "details": "Compute the SHA256 hash of the memory dump device to verify integrity. Use 'sha256sum /dev/sdc'",
        "points": 20,
        "checkType": null,
        "interactionTarget": null,
        "onInteract": null,
        "hintCost": 4,
        "hasHint": true,
        "hint": "Hash the device: sha256sum /dev/sdc",
        "checkCommand": "sha256sum",
        "checkArgs": ["/dev/sdc"]
      },
      {
        "id": "mem_task_4",
        "title": "Create working copy of memory image",
        "details": "Create a forensic copy of the memory dump for analysis. Use 'dd if=/dev/sdc of=/forensic/memdump.img'",
        "points": 25,
        "checkType": null,
        "interactionTarget": null,
        "onInteract": null,
        "hintCost": 5,
        "hasHint": true,
        "hint": "Create copy: dd if=/dev/sdc of=/forensic/memdump.img",
        "checkCommand": "dd",
        "checkArgs": ["if=/dev/sdc", "of=/forensic/memdump.img"]
      },
      {
        "id": "mem_task_5",
        "title": "Mount the device",
        "details": "Use 'mount /dev/sdc1 /mnt/memdump'",
        "points": 20,
        "checkType": null,
        "interactionTarget": null,
        "onInteract": null,
        "hintCost": 4,
        "hasHint": false,
        "checkCommand": "mount",
        "checkArgs": [
          "/dev/sdc1",
          "/mnt/memdump"
        ]
      },
      {
        "id": "mem_task_6",
        "title": "List dump files",
        "details": "Use 'ls /mnt/memdump'",
        "points": 15,
        "checkType": null,
        "interactionTarget": null,
        "onInteract": null,
        "hintCost": 3,
        "hasHint": false,
        "checkCommand": "ls",
        "checkArgs": [
          "/mnt/memdump"
        ]
      },
      {
        "id": "mem_task_7",
        "title": "Analyze processes",
        "details": "Use 'cat /mnt/memdump/process_list.txt'",
        "points": 20,
        "checkType": null,
        "interactionTarget": null,
        "onInteract": null,
        "hintCost": 4,
        "hasHint": false,
        "checkCommand": "cat",
        "checkArgs": [
          "/mnt/memdump/process_list.txt"
        ]
      },
      {
        "id": "mem_task_8",
        "title": "Get memory dump metadata",
        "details": "Use 'memdump-info' to display memory dump analysis and statistics",
        "points": 20,
        "checkType": null,
        "interactionTarget": null,
        "onInteract": null,
        "hintCost": 4,
        "hasHint": false,
        "checkCommand": "memdump-info",
        "checkArgs": []
      },
      {
        "id": "mem_task_9",
        "title": "Scan for malicious signatures",
        "details": "Use 'find-malware' to identify suspicious processes and malware in memory",
        "points": 25,
        "checkType": null,
        "interactionTarget": null,
        "onInteract": null,
        "hintCost": 5,
        "hasHint": false,
        "checkCommand": "find-malware",
        "checkArgs": []
      }
    ]
  }
}
